â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              UBUNTU SERVER - EERSTE STAPPEN                              â•‘
â•‘          (Voor wanneer je GEEN IAM User kunt maken)                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” STAP 1: Check of Ubuntu server een EC2 instance is
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    # Snelle check:
    curl -s http://169.254.169.254/latest/meta-data/instance-id

    Als je een instance ID ziet (zoals i-0123456789abcdef):
    âœ… HET IS EC2! â†’ Gebruik IAM Role (makkelijk!)
    
    Als je "Connection timeout" of error ziet:
    âŒ GEEN EC2 â†’ Vraag school om IAM User


    # Of gebruik automatische check:
    bash scripts/check-server-type.sh


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… Als HET IS EC2:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    ğŸ“‹ In AWS Console (op je Windows machine):
    
    1. IAM â†’ Roles â†’ Create role
    2. Trusted entity: AWS service â†’ EC2
    3. Create policy (JSON):
       {
         "Version": "2012-10-17",
         "Statement": [{
           "Effect": "Allow",
           "Action": ["events:PutEvents"],
           "Resource": "*"
         }]
       }
    4. Policy name: SOARMonitorEventBridgePolicy
    5. Role name: SOAR-Ubuntu-Monitor-Role
    6. EC2 â†’ Instances â†’ Je Ubuntu server â†’ Actions â†’ Security
       â†’ Modify IAM role â†’ Selecteer de role


    ğŸ“‹ Op Ubuntu Server:
    
    # Verwijder oude SSO credentials
    rm -rf ~/.aws/credentials
    
    # Config alleen region (GEEN credentials!)
    mkdir -p ~/.aws
    echo "[default]
    region = eu-central-1
    output = json" > ~/.aws/config
    
    # Test - gebruikt automatisch EC2 role!
    aws sts get-caller-identity --region eu-central-1
    
    # Je moet je role ARN zien, GEEN expired error! âœ…
    
    # Test EventBridge
    aws events put-events \
      --entries '[{"Source":"test","DetailType":"test","Detail":"{}"}]' \
      --region eu-central-1
    
    # Test monitoring
    sudo /usr/local/bin/monitor-failed-logins.sh


    âœ… KLAAR! De role blijft permanent, geen expiration!


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âŒ Als GEEN EC2:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    Je hebt 2 opties:


    OPTIE 1: Vraag school om IAM User te maken
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Vraag je docent/admin om:
    
    1. IAM User te maken: "soar-ubuntu-monitor"
    2. Policy: events:PutEvents permission
    3. Access Keys te genereren
    4. De Access Key en Secret Key aan jou te geven
    
    Dan op Ubuntu:
    
    rm -rf ~/.aws/credentials
    aws configure
    # Vul Access Key en Secret Key in (GEEN session token!)


    OPTIE 2: SSO Token Handmatig Refreshen (Niet ideaal)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Elke keer als token expired:
    
    # Op Windows:
    aws sso login --profile fictisb
    aws configure export-credentials --profile fictisb
    
    # Kopieer nieuwe credentials naar Ubuntu
    aws configure
    # Plak Access Key, Secret Key EN Session Token
    
    âš ï¸  NADEEL: Dit moet je elke paar uur herhalen!


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“š MEER INFO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    FIX-TOKEN-WITH-IAM-ROLE.md  - Volledige IAM Role guide
    QUICK-FIX-TOKEN.md          - Alle opties uitgelegd
    scripts/check-server-type.sh - Automatische server check


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ TL;DR:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    # Run dit op Ubuntu:
    curl -s http://169.254.169.254/latest/meta-data/instance-id

    # Als je instance ID ziet:
    â†’ Maak IAM Role
    â†’ Attach aan EC2
    â†’ rm ~/.aws/credentials
    â†’ âœ… Klaar!

    # Als je error ziet:
    â†’ Vraag school om IAM User
    â†’ Of refresh SSO elke paar uur (niet ideaal)


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
